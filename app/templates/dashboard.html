<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard - Campus Lost & Found</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/feather-icons"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-100 to-green-50">

  <!-- Header -->
  <header class="py-4 bg-white shadow mb-4">
    <div class="container mx-auto px-4 flex justify-between items-center">
      <h1 class="text-2xl font-bold text-blue-600">Campus Lost & Found</h1>
      <div class="flex items-center gap-4">
        <a href="{% url 'index' %}" class="flex items-center gap-2 bg-blue-600 text-white px-3 py-1.5 rounded hover:bg-blue-700 transition font-medium">
          <i data-feather="home" class="h-4 w-4"></i> Home
        </a>
        <span class="text-gray-700 font-medium hidden sm:inline">Hi, {{ user.username }}</span>
        <a href="{% url 'logout' %}" class="flex items-center gap-2 bg-blue-600 text-white px-3 py-1.5 rounded hover:bg-blue-700 transition font-medium">
          <i data-feather="log-out" class="h-4 w-4"></i> Logout
        </a>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-8">
    <!-- Welcome Message -->
    <div class="mb-8">
      <h2 class="text-3xl font-bold mb-2">Welcome back, {{ user.username }}!</h2>
      <p class="text-gray-500">Manage your lost and found reports</p>
    </div>

    <!-- Quick Actions -->
    <div class="grid md:grid-cols-2 gap-6 mb-8">
      <div class="group hover:shadow-lg transition-all duration-300 border rounded-lg border-blue-200 p-6">
        <a href="{% url 'report_lost' %}" class="flex items-center gap-4">
          <div class="p-3 bg-blue-100 rounded-full group-hover:bg-blue-200 transition-colors">
            <i data-feather="search" class="h-6 w-6 text-blue-600"></i>
          </div>
          <div>
            <h3 class="font-semibold text-lg">Report Lost Item</h3>
            <p class="text-sm text-gray-500">Lost something on campus? Report it here</p>
          </div>
        </a>
      </div>

      <div class="group hover:shadow-lg transition-all duration-300 border rounded-lg border-green-200 p-6">
        <a href="{% url 'report_found' %}" class="flex items-center gap-4">
          <div class="p-3 bg-green-100 rounded-full group-hover:bg-green-200 transition-colors">
            <i data-feather="package" class="h-6 w-6 text-green-600"></i>
          </div>
          <div>
            <h3 class="font-semibold text-lg">Report Found Item</h3>
            <p class="text-sm text-gray-500">Found something? Help others find it!</p>
          </div>
        </a>
      </div>
    </div>
      <div class="grid md:grid-cols-2 gap-6 mb-8">
      </div>

    {% if notifications %}
    <div class="bg-yellow-50 border border-yellow-300 rounded-lg p-6 mb-8">
      <h3 class="text-2xl font-semibold mb-4 text-yellow-800 flex items-center gap-2">
        <i data-feather="bell" class="h-6 w-6"></i> Potential Matches Found ({{ notification_count }})
      </h3>
      <div class="space-y-4">
        {% for note in notifications %}
          {% if note.type == 'LOST_MATCH' %}
            <a href="{% url 'view_notification' note.my_item_id note.match_id %}" 
               class="block p-4 bg-white border border-yellow-200 rounded-lg shadow-sm hover:shadow-md hover:border-yellow-400 transition cursor-pointer">
                
              <p class="font-medium text-yellow-700">
                ðŸ¥³ **Match Found for your LOST item: {{ note.my_item_name }}**
              </p>
              <p class="text-sm text-gray-600 mt-1">
                A potential **FOUND item** named **{{ note.match_item_name }}** was reported by **{{ note.match_user }}** ({{ note.score }}% match).
              </p>
              <p class="text-xs text-blue-600 mt-2 flex items-center gap-1">
                <i data-feather="eye" class="h-3 w-3"></i> Click to view details and founder's contact info
              </p>
            </a>
          {% endif %}
          {% endfor %}
      </div>
    </div>
    {% endif %}

    
    <div class="bg-white rounded-lg border p-6">
      

    <!-- My Reports Section -->
    <div class="bg-white rounded-lg border p-6">
      <h3 class="text-2xl font-semibold mb-6">My Reports</h3>

      <!-- Tabs -->
      <div class="flex gap-2 mb-6">
        <button id="tab-lost" class="flex items-center gap-2 px-4 py-2 rounded-lg text-blue-600 bg-blue-50 font-semibold">
          <i data-feather="search" class="h-4 w-4"></i> My Lost Items (<span id="lost-count">{{ lost_items.count }}</span>)
        </button>
        <button id="tab-found" class="flex items-center gap-2 px-4 py-2 rounded-lg text-green-600 bg-green-50 font-semibold">
          <i data-feather="package" class="h-4 w-4"></i> My Found Items (<span id="found-count">{{ found_items.count }}</span>)
        </button>
      </div>

      <!-- Tab Contents -->
      <!-- LOST ITEMS -->
      <div id="content-lost" class="space-y-4">
        {% if lost_items %}
          {% for item in lost_items %}
            <div class="border p-4 rounded-lg flex gap-4 items-center">
              {% if item.photo %}
                <img src="{{ item.photo.url }}" alt="{{ item.name }}" class="w-20 h-20 rounded object-cover border">
              {% endif %}
              <div class="flex-1">
                <h4 class="font-semibold text-lg text-blue-700">{{ item.name }}</h4>
                <p class="text-sm text-gray-600">{{ item.description|truncatewords:15 }}</p>
                <p class="text-xs text-gray-400 mt-1">Reported on {{ item.date_reported|date:"M d, Y H:i" }}</p>
              </div>
              <a href="{% url 'delete_lost' item.id %}" class="text-red-600 hover:underline text-sm font-medium">Delete</a>
            </div>
          {% endfor %}
        {% else %}
          <p class="text-gray-500">No lost items reported yet.</p>
        {% endif %}
      </div>

      <!-- FOUND ITEMS -->
      <div id="content-found" class="space-y-4 hidden">
        {% if found_items %}
          {% for item in found_items %}
            <div class="border p-4 rounded-lg flex gap-4 items-center">
              {% if item.photo %}
                <img src="{{ item.photo.url }}" alt="{{ item.name }}" class="w-20 h-20 rounded object-cover border">
              {% endif %}
              <div class="flex-1">
                <h4 class="font-semibold text-lg text-green-700">{{ item.name }}</h4>
                <p class="text-sm text-gray-600">{{ item.description|truncatewords:15 }}</p>
                <p class="text-xs text-gray-400 mt-1">Reported on {{ item.date_reported|date:"M d, Y H:i" }}</p>
              </div>
              <a href="{% url 'delete_found' item.id %}" class="text-red-600 hover:underline text-sm font-medium">Delete</a>
            </div>
          {% endfor %}
        {% else %}
          <p class="text-gray-500">No found items reported yet.</p>
        {% endif %}
      </div>

    </div>
  </main>

  <script>
    feather.replace();

    // Tab switching logic
    const tabLost = document.getElementById('tab-lost');
    const tabFound = document.getElementById('tab-found');
    const contentLost = document.getElementById('content-lost');
    const contentFound = document.getElementById('content-found');

    tabLost.addEventListener('click', () => {
      contentLost.classList.remove('hidden');
      contentFound.classList.add('hidden');
      tabLost.classList.add('bg-blue-100', 'font-bold');
      tabFound.classList.remove('bg-green-100', 'font-bold');
    });

    tabFound.addEventListener('click', () => {
      contentFound.classList.remove('hidden');
      contentLost.classList.add('hidden');
      tabFound.classList.add('bg-green-100', 'font-bold');
      tabLost.classList.remove('bg-blue-100', 'font-bold');
    });
  </script>

</body>
</html>
